(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4827:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return $}});var n=r(1002),o=r(5604),a=r(1785),i=r.n(a),c=r(5262),u=r(2700),s=r(9568);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,u.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var f,p,h,v,g={create:(f=(0,n.Z)(i().mark(function e(t){var r,n,o,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.resource,o=t.summary,a=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]"),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify([].concat((0,s.Z)(a),[{id:m(20),resource:n,summary:o}]))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(e){return f.apply(this,arguments)}),delete:(p=(0,n.Z)(i().mark(function e(t){var r,n,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]"),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify((0,s.Z)(o.filter(function(e){return e.id!==n})))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(e){return p.apply(this,arguments)}),readList:(h=(0,n.Z)(i().mark(function e(){var t,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(null!==(t=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==t?t:"[]"),e.abrupt("return",{data:r.map(function(e){return d({id:e.id},e.summary)})});case 2:case"end":return e.stop()}},e)})),function(){return h.apply(this,arguments)}),update:(v=(0,n.Z)(i().mark(function e(t){var r,n,o,a,c,u;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=t.resource,a=t.summary,-1!==(u=(c=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]")).findIndex(function(e){return e.id===n}))&&(c[u]=d(d({},c[u]),{},{resource:d(d({},c[u].resource),o),summary:d(d({},c[u].summary),a)})),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify(c)),e.abrupt("return");case 6:case"end":return e.stop()}},e)})),function(e){return v.apply(this,arguments)})};function m(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*n));return t}var b=r(6494),w=c.GitHubOAuthSdk.of({baseUrl:"https://app.divops.kr/github-api",getAuthorization:function(){var e=localStorage.getItem("authorization");if(null==e||""===e)throw Error("Authorization is null. (".concat(e,")"));return e}}),y=null!=b.env.NEXT_PUBLIC_IS_LOCAL,k=y?{fetchUser:function(){return{data:{login:"CreatiCoding"}}},loginUser:function(){}}:w.UserAPI,Z=y?g:w.ResourceAPI.of({model:"gtd-todo"}),O=r(4531),S=r(230),x=r(7048);function T(e){var t=e.size;return(0,x.tZ)("div",{css:(0,S.css)("width:100%;height:",t,"px;","")})}var P={Horizontal:function(e){var t=e.children,r=e.className,n=e.align;return(0,x.tZ)("div",{className:r,css:(0,S.css)("display:flex;justify-content:",void 0===n?"center":n,";align-items:center;",""),children:t})},Vertical:function(e){var t=e.children,r=e.className,n=e.align,o=void 0===n?"center":n;return(0,x.tZ)("div",{className:r,css:(0,S.css)("display:flex;flex-direction:column;align-items:","right"===o?"end":"left"===o?"start":"center",";",""),children:t})}},I=r(9953),_={name:"255c6r",styles:"word-break:keep-all"},j={name:"vvvkso",styles:"word-break:keep-all;resize:none;width:100%;outline:none!important;:focus{background-color:#f0f0f0;}"};function N(e){var t,r=e.defaultText,o=e.onSubmit,a=(0,I.useState)(null!=r?r:""),c=a[0],u=a[1];return(0,x.BX)(x.HY,{children:[(0,x.tZ)("textarea",{spellCheck:!1,css:j,rows:Math.max(null!==(t=null==c?void 0:c.split("\n").length)&&void 0!==t?t:0,2),value:c,onChange:function(e){return u(e.target.value)}}),(0,x.tZ)(T,{size:4}),(0,x.tZ)("button",{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u(""),e.next=3,o(c);case 3:case"end":return e.stop()}},e)})),css:_,children:"입력"})]})}var z=r(1387),E=r.n(z),L=r(1446),C=r(73),A=["UserKey"];function X(){var e=(0,I.useState)(!0),t=e[0],r=e[1],n=(0,L.NL)();(0,I.useEffect)(function(){var e=setTimeout(function(){return r(!1)},200);return function(){return clearTimeout(e)}},[]);var o=(0,C.a)([].concat(A,[t]),k.fetchUser,{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0}),a=o.data,i=o.refetch,c=function(){n.invalidateQueries(A),localStorage.removeItem("authorization"),i()};return{data:null==a?void 0:a.data,isLoading:t,login:k.loginUser,logout:c}}X.key=A;var D={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},B={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},G={name:"nkt64x",styles:"margin-right:10px"};function H(){var e,t=X(),r=t.data,n=t.login,o=t.logout;return(0,x.BX)(P.Horizontal,{align:"space-between",children:[(0,x.tZ)("h1",{children:"Getting Things Done"}),(0,x.BX)(P.Horizontal,{align:"right",children:[(0,x.tZ)("h4",{css:G,children:null!==(e=null==r?void 0:r.login)&&void 0!==e?e:"guest"}),null==r?(0,x.tZ)("button",{onClick:n,css:B,children:"로그인"}):(0,x.tZ)("button",{onClick:function(){o(),E().reload()},css:D,children:"로그아웃"})]})]})}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function J(e){var t,r=X().data,o=(0,C.a)(["fetchList",null==r?void 0:r.login,e],(0,n.Z)(i().mark(function t(){return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((null==r?void 0:r.login)!=null){t.next=4;break}t.t0=[],t.next=7;break;case 4:return t.next=6,q.of(e).readList();case 6:t.t0=t.sent.data;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)})),{initialData:[]}),a=o.data,c=o.refetch;return[a,c,o.isLoading,o.isFetching]}var q={of:function(e){if("todo"===e)return Z}};function R(e){var t=e.left,r=e.right;return(0,x.tZ)("li",{children:(0,x.BX)(P.Horizontal,{children:[t,r]})})}var M={name:"1watsfl",styles:"width:100%;font-size:1.6rem;word-break:keep-all;white-space:pre-line"};function Q(e){var t=e.className,r=e.children;return(0,x.tZ)("p",{className:t,css:M,children:r})}var Y={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"};function F(e){var t=e.className,r=e.onClick,n=e.children;return(0,x.tZ)("button",{className:t,css:Y,onClick:r,children:n})}var K={name:"1cwazio",styles:"padding:3px"},V={name:"rbjt4m",styles:'resize:none;width:100%;font-size:1.6rem;word-break:keep-all;white-space:pre-line;font-family:"Noto Sans KR",sans-serif'};function W(e){var t=e.data,r=(0,I.useState)(t.contents),a=r[0],c=r[1],u=(0,I.useState)("view"),s=u[0],l=u[1],d=J("todo"),f=(0,o.Z)(d,2)[1];return"edit"===s?(0,x.tZ)(R,{left:(0,x.tZ)("textarea",{css:V,value:a,rows:a.split("\n").length,onChange:function(e){return c(e.target.value)}}),right:(0,x.BX)(x.HY,{children:[(0,x.tZ)(F,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.update({id:t.id,resource:{contents:a},summary:{contents:a}});case 2:return e.next=4,f();case 4:l("view");case 5:case"end":return e.stop()}},e)})),children:"제출"}),(0,x.tZ)(F,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c(t.contents),l("view");case 2:case"end":return e.stop()}},e)})),children:"취소"})]})}):(0,x.tZ)(R,{left:(0,x.tZ)(Q,{css:K,children:a}),right:(0,x.BX)(x.HY,{children:[(0,x.tZ)(F,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l("edit");case 1:case"end":return e.stop()}},e)})),children:"수정"}),(0,x.tZ)(F,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.delete({id:t.id});case 2:return e.next=4,f();case 4:case"end":return e.stop()}},e)})),children:"삭제"})]})})}var $=function(){var e,t,r,a,c,s,l,d=(r=(t=(0,z.useRouter)(),{resetQueryParam:function(e){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){(0,u.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t.query);delete r[e],t.replace({pathname:t.pathname,query:r})}}).resetQueryParam,a=(0,z.useRouter)(),s=(c=(0,I.useState)(!1))[0],l=c[1],(0,I.useEffect)(function(){if(a.isReady){var e=a.query.code;if(null==e||Array.isArray(e)){l(!1);return}l(!0),localStorage.setItem("authorization",e),r("code")}},[a]),{loginLoading:s}).loginLoading,f=X(),p=f.isLoading,h=f.data,v=J("todo"),g=(0,o.Z)(v,2),m=g[0],b=g[1];return d||p?(0,x.tZ)("div",{children:"로그인 중"}):null==h?(0,x.BX)("main",{children:[(0,x.tZ)(T,{size:10}),(0,x.tZ)(H,{}),(0,x.tZ)(T,{size:30}),(0,x.tZ)(Q,{children:"환영합니다, 로그인을 하여 GTD를 시작해보세요!"})]}):(0,x.BX)("main",{children:[(0,x.tZ)(T,{size:10}),(0,x.tZ)(H,{}),(0,x.tZ)(T,{size:30}),(0,x.BX)(O.W,{width:720,children:[(0,x.tZ)(P.Vertical,{align:"right",children:(0,x.tZ)(N,{onSubmit:(e=(0,n.Z)(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.create({resource:{contents:t},summary:{contents:t}});case 2:return e.next=4,b();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})})}),(0,x.tZ)(T,{size:20}),(0,x.tZ)("ul",{children:m.map(function(e){return(0,x.tZ)(W,{data:e},e.id)})})]})]})}},9638:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4827)}])}},function(e){e.O(0,[930,774,888,179],function(){return e(e.s=9638)}),_N_E=e.O()}]);