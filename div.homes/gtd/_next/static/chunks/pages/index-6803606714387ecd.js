(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{990:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return V}});var n=r(1002),o=r(5604),a=r(1785),i=r.n(a),c=r(1387),u=r.n(c),s=r(9953),l=r(5262),d=r(2700),f=r(9568);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,d.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var v,g,m,b,y={create:(v=(0,n.Z)(i().mark(function e(t){var r,n,o,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.resource,o=t.summary,a=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]"),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify([].concat((0,f.Z)(a),[{resource:n,summary:h({id:w(20)},o)}]))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(e){return v.apply(this,arguments)}),delete:(g=(0,n.Z)(i().mark(function e(t){var r,n,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]"),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify((0,f.Z)(o.filter(function(e){return e.summary.id!==n})))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(e){return g.apply(this,arguments)}),readList:(m=(0,n.Z)(i().mark(function e(){var t,r;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.parse(null!==(t=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==t?t:"[]"),e.abrupt("return",{data:r.map(function(e){return e.summary})});case 2:case"end":return e.stop()}},e)})),function(){return m.apply(this,arguments)}),update:(b=(0,n.Z)(i().mark(function e(t){var r,n,o,a,c,u;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,o=t.resource,a=t.summary,-1!==(u=(c=JSON.parse(null!==(r=localStorage.getItem("TEST_GtdTodoAPI_LIST"))&&void 0!==r?r:"[]")).findIndex(function(e){return e.summary.id===n}))&&(c[u]={resource:h(h({},c[u].resource),o),summary:h(h(h({},c[u].summary),a),{},{id:n})}),localStorage.setItem("TEST_GtdTodoAPI_LIST",JSON.stringify(c)),e.abrupt("return");case 6:case"end":return e.stop()}},e)})),function(e){return b.apply(this,arguments)})};function w(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*n));return t}var k=r(6494),O=l.GitHubOAuthSdk.of({baseUrl:"https://app.divops.kr/github-api",getAuthorization:function(){var e=localStorage.getItem("authorization");if(null==e||""===e)throw Error("Authorization is null. (".concat(e,")"));return e}}),Z=null!=k.env.NEXT_PUBLIC_IS_LOCAL,S=Z?{fetchUser:function(){return{data:{login:"CreatiCoding"}}},loginUser:function(){}}:O.UserAPI,x=Z?y:O.ResourceAPI.of({model:"gtd-todo"}),T=r(4531),P=r(230),I=r(7048);function _(e){var t=e.size;return(0,I.tZ)("div",{css:(0,P.css)("width:100%;height:",t,"px;","")})}var j={Horizontal:function(e){var t=e.children,r=e.className,n=e.align;return(0,I.tZ)("div",{className:r,css:(0,P.css)("display:flex;justify-content:",void 0===n?"center":n,";align-items:center;",""),children:t})},Vertical:function(e){var t=e.children,r=e.className,n=e.align,o=void 0===n?"center":n;return(0,I.tZ)("div",{className:r,css:(0,P.css)("display:flex;flex-direction:column;align-items:","right"===o?"end":"left"===o?"start":"center",";",""),children:t})}},N=r(1446),E=r(73),C=["UserKey"];function L(){var e=(0,s.useState)(!0),t=e[0],r=e[1],n=(0,N.NL)();(0,s.useEffect)(function(){var e=setTimeout(function(){return r(!1)},200);return function(){return clearTimeout(e)}},[]);var o=(0,E.a)([].concat(C,[t]),S.fetchUser,{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0}),a=o.data,i=o.refetch,c=function(){n.invalidateQueries(C),localStorage.removeItem("authorization"),i()};return{data:null==a?void 0:a.data,isLoading:t,login:S.loginUser,logout:c}}L.key=C;var z={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},A={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},X={name:"nkt64x",styles:"margin-right:10px"};function D(){var e,t=L(),r=t.data,n=t.login,o=t.logout;return(0,I.BX)(j.Horizontal,{align:"space-between",children:[(0,I.tZ)("h1",{children:"Getting Things Done"}),(0,I.BX)(j.Horizontal,{align:"right",children:[(0,I.tZ)("h4",{css:X,children:null!==(e=null==r?void 0:r.login)&&void 0!==e?e:"guest"}),null==r?(0,I.tZ)("button",{onClick:n,css:A,children:"로그인"}):(0,I.tZ)("button",{onClick:function(){o(),u().reload()},css:z,children:"로그아웃"})]})]})}function B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){var t,r=L().data,o=(0,E.a)(["fetchList",null==r?void 0:r.login,e],(0,n.Z)(i().mark(function t(){return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((null==r?void 0:r.login)!=null){t.next=4;break}t.t0=[],t.next=7;break;case 4:return t.next=6,H.of(e).readList();case 6:t.t0=t.sent.data;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)})),{initialData:[]}),a=o.data,c=o.refetch;return[a,c,o.isLoading,o.isFetching]}var H={of:function(e){if("todo"===e)return x}};function U(e){var t=e.left,r=e.right;return(0,I.tZ)("li",{children:(0,I.BX)(j.Horizontal,{children:[t,r]})})}var J={name:"1watsfl",styles:"width:100%;font-size:1.6rem;word-break:keep-all;white-space:pre-line"};function q(e){var t=e.className,r=e.children;return(0,I.tZ)("p",{className:t,css:J,children:r})}var R={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"};function M(e){var t=e.className,r=e.onClick,n=e.children;return(0,I.tZ)("button",{className:t,css:R,onClick:r,children:n})}function Q(e){var t=e.data,r=(0,s.useState)(t.contents),a=r[0],c=r[1],u=(0,s.useState)("view"),l=u[0],d=u[1],f=G("todo"),p=(0,o.Z)(f,2)[1];return"edit"===l?(0,I.tZ)(U,{left:(0,I.tZ)("textarea",{value:a,onChange:function(e){return c(e.target.value)}}),right:(0,I.BX)(I.HY,{children:[(0,I.tZ)(M,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.update({id:t.id,resource:{contents:a},summary:{contents:null==a?void 0:a.split("\n")[0]}});case 2:return e.next=4,p();case 4:d("view");case 5:case"end":return e.stop()}},e)})),children:"제출"}),(0,I.tZ)(M,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c(t.contents),d("view");case 2:case"end":return e.stop()}},e)})),children:"취소"})]})}):(0,I.tZ)(U,{left:(0,I.tZ)(q,{children:a}),right:(0,I.BX)(I.HY,{children:[(0,I.tZ)(M,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d("edit");case 1:case"end":return e.stop()}},e)})),children:"수정"}),(0,I.tZ)(M,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.delete({id:t.id});case 2:return e.next=4,p();case 4:case"end":return e.stop()}},e)})),children:"삭제"})]})})}var Y={name:"255c6r",styles:"word-break:keep-all"},F={name:"vvvkso",styles:"word-break:keep-all;resize:none;width:100%;outline:none!important;:focus{background-color:#f0f0f0;}"},V=function(){var e,t,r=(0,c.useRouter)(),a=(0,s.useState)(!1),u=a[0],l=a[1],f=(t=(0,c.useRouter)(),{resetQueryParam:function(e){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?B(Object(r),!0).forEach(function(t){(0,d.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t.query);delete r[e],t.replace({pathname:t.pathname,query:r})}}).resetQueryParam,p=L(),h=p.isLoading,v=p.data;p.login,p.logout;var g=G("todo"),m=(0,o.Z)(g,2),b=m[0],y=m[1],w=(0,s.useState)(),k=w[0],O=w[1];return((0,s.useEffect)(function(){if(r.isReady){var e=r.query.code;if(null==e||Array.isArray(e)){l(!1);return}l(!0),localStorage.setItem("authorization",e),f("code")}},[r]),u||h)?(0,I.tZ)("div",{children:"로그인 중"}):(0,I.BX)("main",{children:[(0,I.tZ)(_,{size:10}),(0,I.tZ)(D,{}),(0,I.tZ)(_,{size:30}),null==v?(0,I.tZ)(I.HY,{}):(0,I.BX)(T.W,{width:720,children:[(0,I.BX)(j.Vertical,{align:"right",children:[(0,I.tZ)("textarea",{spellCheck:!1,css:F,rows:Math.max(null!==(e=null==k?void 0:k.split("\n").length)&&void 0!==e?e:0,2),value:k,onChange:function(e){return O(e.target.value)}}),(0,I.tZ)(_,{size:4}),(0,I.tZ)("button",{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.create({resource:{contents:k},summary:{contents:null==k?void 0:k.split("\n")[0]}});case 2:return O(""),e.next=5,y();case 5:case"end":return e.stop()}},e)})),css:Y,children:"입력"})]}),(0,I.tZ)(_,{size:20}),(0,I.tZ)("ul",{children:b.map(function(e){return(0,I.tZ)(Q,{data:e},e.id)})})]})]})}},9638:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(990)}])}},function(e){e.O(0,[930,774,888,179],function(){return e(e.s=9638)}),_N_E=e.O()}]);