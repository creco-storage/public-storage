(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9079:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var r=n(1002),o=n(6363),i=n(1785),u=n.n(i),c=n(297),a=n.n(c),l=n(1387),s=n(9953),d=n(5262).GitHubOAuthSdk.of({baseUrl:"https://app.divops.kr/github-api",getAuthorization:function(){var e=localStorage.getItem("authorization");if(null==e||""===e)throw Error("Authorization is null. (".concat(e,")"));return e}}),f=d.UserAPI,h=d.ResourceAPI.of({model:"gtd-todo"}),p=n(2700);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var v=n(4039),b=n(505),y=["UserKey"];function m(){var e=(0,s.useState)(!0),t=e[0],n=e[1],r=(0,v.NL)();(0,s.useEffect)(function(){var e=setTimeout(function(){return n(!1)},200);return function(){return clearTimeout(e)}},[]);var o=(0,b.a)([].concat(y,[t]),f.fetchUser,{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0}),i=o.data,u=o.refetch,c=function(){r.invalidateQueries(y),localStorage.removeItem("authorization"),u()};return{data:null==i?void 0:i.data,isLoading:t,login:f.loginUser,logout:c}}m.key=y;var O={of:function(e){if("todo"===e)return h}},w=n(7048),k={name:"dg4oy",styles:"border:unset;background:unset;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},Z=function(){var e,t,n,i,c,d,f,v,y=(0,l.useRouter)(),Z=(0,s.useState)(!1),P=Z[0],_=Z[1],j=(t=(0,l.useRouter)(),{resetQueryParam:function(e){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,p.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.query);delete n[e],t.replace({pathname:t.pathname,query:n})}}).resetQueryParam,x=m(),E=x.isLoading,S=x.data,A=x.login,C=x.logout,X=(n="todo",i=m().data,d=(c=(0,b.a)(["fetchList",null==i?void 0:i.login,n],(0,r.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((null==i?void 0:i.login)!=null){e.next=4;break}e.t0=[],e.next=7;break;case 4:return e.next=6,O.of(n).readList();case 6:e.t0=e.sent.data;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}},e)})),{initialData:[]})).data,f=c.refetch,[d,f,v=c.isLoading,c.isFetching]),D=(0,o.Z)(X,2),L=D[0],N=D[1],z=(0,s.useState)(),B=z[0],I=z[1];return((0,s.useEffect)(function(){if(y.isReady){var e=y.query.code;if(null==e||Array.isArray(e)){_(!1);return}_(!0),localStorage.setItem("authorization",e),j("code")}},[y]),P||E)?(0,w.tZ)("div",{children:"로그인 중"}):(0,w.BX)("div",{children:[(0,w.tZ)(a(),{children:(0,w.tZ)("title",{children:"Hello world!"})}),(0,w.BX)("main",{children:[(0,w.tZ)("h1",{children:"Getting Things Done"}),(0,w.BX)("h4",{children:["welcome ",null!==(e=null==S?void 0:S.login)&&void 0!==e?e:"guest","!"]}),null==S?(0,w.tZ)("button",{onClick:A,children:"로그인"}):(0,w.tZ)("button",{onClick:function(){C(),y.reload()},children:"로그아웃"}),(0,w.BX)("div",{children:[(0,w.tZ)("input",{value:B,onChange:function(e){return I(e.target.value)}}),(0,w.tZ)("br",{}),(0,w.tZ)("button",{onClick:(0,r.Z)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.create({resource:{contents:B},summary:{contents:null==B?void 0:B.split("\n")[0]}});case 2:return I(""),e.next=5,N();case 5:case"end":return e.stop()}},e)})),children:"입력"})]}),(0,w.tZ)("ul",{children:L.map(function(e){return(0,w.BX)("li",{children:[(0,w.tZ)("p",{children:e.contents}),(0,w.tZ)("button",{css:k,onClick:(0,r.Z)(u().mark(function t(){return u().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.delete({id:e.id});case 2:return t.next=4,N();case 4:case"end":return t.stop()}},t)})),children:"삭제"})]})})})]})]})}},9638:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(9079)}])}},function(e){e.O(0,[955,774,888,179],function(){return e(e.s=9638)}),_N_E=e.O()}]);