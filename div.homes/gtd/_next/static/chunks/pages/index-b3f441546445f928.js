(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1005:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return M}});var n=r(1002),o=r(5604),i=r(1785),a=r.n(i),u=r(5262),c=r(2700),s=r(9568);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach(function(e){(0,c.Z)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function d(t){var e,r,o,i;return{create:(e=(0,n.Z)(a().mark(function e(r){var n,o,i,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.resource,i=r.summary,u=JSON.parse(null!==(n=localStorage.getItem(t))&&void 0!==n?n:"[]"),localStorage.setItem(t,JSON.stringify([].concat((0,s.Z)(u),[{id:g(20),resource:o,summary:i}]))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),delete:(r=(0,n.Z)(a().mark(function e(r){var n,o,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.id,i=JSON.parse(null!==(n=localStorage.getItem(t))&&void 0!==n?n:"[]"),localStorage.setItem(t,JSON.stringify((0,s.Z)(i.filter(function(t){return t.id!==o})))),e.abrupt("return");case 4:case"end":return e.stop()}},e)})),function(t){return r.apply(this,arguments)}),readList:(o=(0,n.Z)(a().mark(function e(){var r,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(null!==(r=localStorage.getItem(t))&&void 0!==r?r:"[]"),e.abrupt("return",{data:n.map(function(t){return f({id:t.id},t.summary)})});case 2:case"end":return e.stop()}},e)})),function(){return o.apply(this,arguments)}),update:(i=(0,n.Z)(a().mark(function e(r){var n,o,i,u,c,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.id,i=r.resource,u=r.summary,-1!==(s=(c=JSON.parse(null!==(n=localStorage.getItem(t))&&void 0!==n?n:"[]")).findIndex(function(t){return t.id===o}))&&(c[s]=f(f({},c[s]),{},{resource:f(f({},c[s].resource),i),summary:f(f({},c[s].summary),u)})),localStorage.setItem(t,JSON.stringify(c)),e.abrupt("return");case 6:case"end":return e.stop()}},e)})),function(t){return i.apply(this,arguments)})}}var p=d("TEST_GtdTodoAPI_LIST"),h=d("TEST_GtdDoneAPI_LIST");function g(t){for(var e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,o=0;o<t;o++)e+=r.charAt(Math.floor(Math.random()*n));return e}var v=r(6494),m=u.GitHubOAuthSdk.of({baseUrl:"https://app.divops.kr/github-api",getAuthorization:function(){var t=localStorage.getItem("authorization");if(null==t||""===t)throw Error("Authorization is null. (".concat(t,")"));return t}}),b=null!=v.env.NEXT_PUBLIC_IS_LOCAL,y=b?{fetchUser:function(){return{data:{login:"CreatiCoding"}}},loginUser:function(){}}:m.UserAPI,O=b?p:m.ResourceAPI.of({model:"gtd-todo"}),w=b?h:m.ResourceAPI.of({model:"gtd-done"}),Z=r(1387),S=r.n(Z),k=r(1446),x=r(73),P=r(9953),j=["UserKey"];function I(){var t=(0,P.useState)(!0),e=t[0],r=t[1],n=(0,k.NL)();(0,P.useEffect)(function(){var t=setTimeout(function(){return r(!1)},200);return function(){return clearTimeout(t)}},[]);var o=(0,x.a)([].concat(j,[e]),y.fetchUser,{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0}),i=o.data,a=o.refetch,u=function(){n.invalidateQueries(j),localStorage.removeItem("authorization"),a()};return{data:null==i?void 0:i.data,isLoading:e,login:y.loginUser,logout:u}}I.key=j;var _=r(2547),T=r(7048),L={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},E={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},N={name:"nkt64x",styles:"margin-right:10px"};function z(){var t,e=I(),r=e.data,n=e.login,o=e.logout;return(0,T.BX)(_.Kq.Horizontal,{align:"space-between",children:[(0,T.tZ)("h1",{children:"Getting Things Done"}),(0,T.BX)(_.Kq.Horizontal,{align:"right",children:[(0,T.tZ)("h4",{css:N,children:null!==(t=null==r?void 0:r.login)&&void 0!==t?t:"guest"}),null==r?(0,T.tZ)("button",{onClick:n,css:E,children:"로그인"}):(0,T.tZ)("button",{onClick:function(){o(),S().reload()},css:L,children:"로그아웃"})]})]})}function A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var C={of:function(t){return"todo"===t?O:w}};function D(){return(0,T.BX)("main",{children:[(0,T.tZ)(_.Ki,{size:10}),(0,T.tZ)(z,{}),(0,T.tZ)(_.Ki,{size:30}),(0,T.tZ)(_.H_,{children:"환영합니다, 로그인을 하여 GTD를 시작해보세요!"})]})}function K(t){var e=t.value,r=t.cases;return(0,T.tZ)(T.HY,{children:r[e]})}var B=r(6262);function q(t){var e=t.data,r=t.viewButtons,n=t.editButtons,i=(0,P.useState)(e.contents),a=i[0],u=i[1],c=(0,P.useState)("view"),s=c[0],l=c[1];return(0,T.tZ)(K,{value:s,cases:{view:(0,T.tZ)(_.HC,{left:(0,T.tZ)(B.K.View,{value:a}),right:Object.entries(r).map(function(t){var e=(0,o.Z)(t,2),r=e[0],n=e[1];return(0,T.tZ)(_.L,{onClick:function(){return n({text:a,setMode:l,setText:u})},children:r})})}),edit:(0,T.tZ)(_.HC,{left:(0,T.tZ)(B.K,{value:a,setValue:u}),right:Object.entries(n).map(function(t){var e=(0,o.Z)(t,2),r=e[0],n=e[1];return(0,T.tZ)(_.L,{onClick:function(){return n({text:a,setMode:l,setText:u})},children:r})})})}})}var M=function(){var t,e,r,i,u,s,l,f,d,p,h,g,v,m=(r=(e=(0,Z.useRouter)(),{resetQueryParam:function(t){var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach(function(e){(0,c.Z)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e.query);delete r[t],e.replace({pathname:e.pathname,query:r})}}).resetQueryParam,i=(0,Z.useRouter)(),s=(u=(0,P.useState)(!1))[0],l=u[1],(0,P.useEffect)(function(){if(i.isReady){var t=i.query.code;if(null==t||Array.isArray(t)){l(!1);return}l(!0),localStorage.setItem("authorization",t),r("code")}},[i]),{loginLoading:s}).loginLoading,b=I(),y=b.isLoading,w=b.data,S=(f="todo",d=I().data,h=(p=(0,x.a)(["fetchList",null==d?void 0:d.login,f],(0,n.Z)(a().mark(function t(){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((null==d?void 0:d.login)!=null){t.next=4;break}t.t0=[],t.next=7;break;case 4:return t.next=6,C.of(f).readList();case 6:t.t0=t.sent.data;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)})),{initialData:[]})).data,g=p.refetch,[h,g,v=p.isLoading,p.isFetching]),k=(0,o.Z)(S,2),j=k[0],L=k[1];return m||y?(0,T.tZ)("div",{children:"로그인 중"}):null==w?(0,T.tZ)(D,{}):(0,T.BX)("main",{children:[(0,T.tZ)(_.Ki,{size:10}),(0,T.tZ)(z,{}),(0,T.tZ)(_.Ki,{size:30}),(0,T.BX)(_.W2,{width:720,children:[(0,T.tZ)(_.Kq.Vertical,{align:"right",children:(0,T.tZ)(_.u,{onSubmit:(t=(0,n.Z)(a().mark(function t(e){return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.create({resource:{contents:e},summary:{contents:e}});case 2:return t.next=4,L();case 4:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)})})}),(0,T.tZ)(_.Ki,{size:20}),(0,T.tZ)("ul",{children:j.map(function(t){var e,r;return(0,T.tZ)(q,{data:t,viewButtons:{수정:function(t){return(0,t.setMode)("edit")},삭제:(e=(0,n.Z)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.delete({id:t.id});case 2:return e.next=4,L();case 4:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})},editButtons:{제출:(r=(0,n.Z)(a().mark(function e(r){var n,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.text,o=r.setMode,e.next=3,O.update({id:t.id,resource:{contents:n},summary:{contents:n}});case 3:return e.next=5,L();case 5:o("view");case 6:case"end":return e.stop()}},e)})),function(t){return r.apply(this,arguments)}),취소:function(e){var r=e.setText,n=e.setMode;r(t.contents),n("view")}}},t.id)})})]})]})}},9638:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(1005)}])}},function(t){t.O(0,[490,774,888,179],function(){return t(t.s=9638)}),_N_E=t.O()}]);