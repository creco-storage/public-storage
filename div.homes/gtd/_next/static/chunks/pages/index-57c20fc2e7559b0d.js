(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{9014:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return U}});var n=r(1002),o=r(5604),a=r(1785),i=r.n(a),u=r(5262),c=r(2700),s=r(9568);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,c.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){var t,r,o,a;return{create:(t=(0,n.Z)(i().mark(function t(r){var n,o,a,u;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.resource,a=r.summary,u=JSON.parse(null!==(n=localStorage.getItem(e))&&void 0!==n?n:"[]"),localStorage.setItem(e,JSON.stringify([].concat((0,s.Z)(u),[{id:g(20),resource:o,summary:a}]))),t.abrupt("return");case 4:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)}),delete:(r=(0,n.Z)(i().mark(function t(r){var n,o,a;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.id,a=JSON.parse(null!==(n=localStorage.getItem(e))&&void 0!==n?n:"[]"),localStorage.setItem(e,JSON.stringify((0,s.Z)(a.filter(function(e){return e.id!==o})))),t.abrupt("return");case 4:case"end":return t.stop()}},t)})),function(e){return r.apply(this,arguments)}),readList:(o=(0,n.Z)(i().mark(function t(){var r,n;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.parse(null!==(r=localStorage.getItem(e))&&void 0!==r?r:"[]"),t.abrupt("return",{data:n.map(function(e){return f({id:e.id},e.summary)})});case 2:case"end":return t.stop()}},t)})),function(){return o.apply(this,arguments)}),update:(a=(0,n.Z)(i().mark(function t(r){var n,o,a,u,c,s;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.id,a=r.resource,u=r.summary,-1!==(s=(c=JSON.parse(null!==(n=localStorage.getItem(e))&&void 0!==n?n:"[]")).findIndex(function(e){return e.id===o}))&&(c[s]=f(f({},c[s]),{},{resource:f(f({},c[s].resource),a),summary:f(f({},c[s].summary),u)})),localStorage.setItem(e,JSON.stringify(c)),t.abrupt("return");case 6:case"end":return t.stop()}},t)})),function(e){return a.apply(this,arguments)})}}var p=d("TEST_GtdTodoAPI_LIST"),h=d("TEST_GtdDoneAPI_LIST");function g(e){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=r.length,o=0;o<e;o++)t+=r.charAt(Math.floor(Math.random()*n));return t}var m=r(6494),v=u.GitHubOAuthSdk.of({baseUrl:"https://app.divops.kr/github-api",getAuthorization:function(){var e=localStorage.getItem("authorization");if(null==e||""===e)throw Error("Authorization is null. (".concat(e,")"));return e}}),b=null!=m.env.NEXT_PUBLIC_IS_LOCAL,y=b?{fetchUser:function(){return{data:{login:"CreatiCoding"}}},loginUser:function(){}}:v.UserAPI,w=b?p:v.ResourceAPI.of({model:"gtd-todo"}),O=b?h:v.ResourceAPI.of({model:"gtd-done"}),Z=r(1387),k=r.n(Z),S=r(1446),x=r(73),P=r(9953),j=["UserKey"];function I(){var e=(0,P.useState)(!0),t=e[0],r=e[1],n=(0,S.NL)();(0,P.useEffect)(function(){var e=setTimeout(function(){return r(!1)},200);return function(){return clearTimeout(e)}},[]);var o=(0,x.a)([].concat(j,[t]),y.fetchUser,{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!0}),a=o.data,i=o.refetch,u=function(){n.invalidateQueries(j),localStorage.removeItem("authorization"),i()};return{data:null==a?void 0:a.data,isLoading:t,login:y.loginUser,logout:u}}I.key=j;var _=r(7765),L=r(7048),C={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},T={name:"1xaqboo",styles:"border:unset;background:unset;word-break:keep-all;text-decoration:underline;cursor:pointer;:hover{color:blue;}"},E={name:"nkt64x",styles:"margin-right:10px"};function N(){var e,t=I(),r=t.data,n=t.login,o=t.logout;return(0,L.BX)(_.Kq.Horizontal,{align:"space-between",children:[(0,L.tZ)("h1",{children:"Getting Things Done"}),(0,L.BX)(_.Kq.Horizontal,{align:"right",children:[(0,L.tZ)("h4",{css:E,children:null!==(e=null==r?void 0:r.login)&&void 0!==e?e:"guest"}),null==r?(0,L.tZ)("button",{onClick:n,css:T,children:"로그인"}):(0,L.tZ)("button",{onClick:function(){o(),k().reload()},css:C,children:"로그아웃"})]})]})}function z(e){var t,r=I().data,o=(0,x.a)(["fetchList",null==r?void 0:r.login,e],(0,n.Z)(i().mark(function t(){return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((null==r?void 0:r.login)!=null){t.next=4;break}t.t0=[],t.next=7;break;case 4:return t.next=6,A.of(e).readList();case 6:t.t0=t.sent.data;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)})),{initialData:[]}),a=o.data,u=o.refetch;return[a,u,o.isLoading,o.isFetching]}var A={of:function(e){return"todo"===e?w:O}},D=r(6262),K={name:"1cwazio",styles:"padding:3px"};function X(e){var t=e.data,r=e.buttons,a=(0,P.useState)(t.contents),u=a[0],c=a[1],s=(0,P.useState)("view"),l=s[0],f=s[1],d=z("todo"),p=(0,o.Z)(d,2)[1];return"edit"===l?(0,L.tZ)(_.HC,{left:(0,L.tZ)(D.K,{value:u,setValue:c}),right:r.map(function(e){return(0,L.tZ)(_.L,{onClick:function(){return e.onClick({text:u,setMode:f,setText:c})},children:e.name})})}):(0,L.tZ)(_.HC,{left:(0,L.tZ)(_.H_,{css:K,children:u}),right:(0,L.BX)(L.HY,{children:[(0,L.tZ)(_.L,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f("edit");case 1:case"end":return e.stop()}},e)})),children:"수정"}),(0,L.tZ)(_.L,{onClick:(0,n.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.delete({id:t.id});case 2:return e.next=4,p();case 4:case"end":return e.stop()}},e)})),children:"삭제"})]})})}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function H(){return(0,L.BX)("main",{children:[(0,L.tZ)(_.Ki,{size:10}),(0,L.tZ)(N,{}),(0,L.tZ)(_.Ki,{size:30}),(0,L.tZ)(_.H_,{children:"환영합니다, 로그인을 하여 GTD를 시작해보세요!"})]})}var U=function(){var e,t,r,a,u,s,l,f=(r=(t=(0,Z.useRouter)(),{resetQueryParam:function(e){var r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){(0,c.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t.query);delete r[e],t.replace({pathname:t.pathname,query:r})}}).resetQueryParam,a=(0,Z.useRouter)(),s=(u=(0,P.useState)(!1))[0],l=u[1],(0,P.useEffect)(function(){if(a.isReady){var e=a.query.code;if(null==e||Array.isArray(e)){l(!1);return}l(!0),localStorage.setItem("authorization",e),r("code")}},[a]),{loginLoading:s}).loginLoading,d=I(),p=d.isLoading,h=d.data,g=z("todo"),m=(0,o.Z)(g,2),v=m[0],b=m[1];return f||p?(0,L.tZ)("div",{children:"로그인 중"}):null==h?(0,L.tZ)(H,{}):(0,L.BX)("main",{children:[(0,L.tZ)(_.Ki,{size:10}),(0,L.tZ)(N,{}),(0,L.tZ)(_.Ki,{size:30}),(0,L.BX)(_.W2,{width:720,children:[(0,L.tZ)(_.Kq.Vertical,{align:"right",children:(0,L.tZ)(_.u,{onSubmit:(e=(0,n.Z)(i().mark(function e(t){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.create({resource:{contents:t},summary:{contents:t}});case 2:return e.next=4,b();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})})}),(0,L.tZ)(_.Ki,{size:20}),(0,L.tZ)("ul",{children:v.map(function(e){var t,r;return(0,L.tZ)(X,{data:e,buttons:[{name:"제출",onClick:(t=(0,n.Z)(i().mark(function t(r){var n,o;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.text,o=r.setMode,t.next=3,w.update({id:e.id,resource:{contents:n},summary:{contents:n}});case 3:return t.next=5,b();case 5:o("view");case 6:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)})},{name:"취소",onClick:(r=(0,n.Z)(i().mark(function t(r){var n,o;return i().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=r.setText,o=r.setMode,n(e.contents),o("view");case 3:case"end":return t.stop()}},t)})),function(e){return r.apply(this,arguments)})}]},e.id)})})]})]})}},9638:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(9014)}])}},function(e){e.O(0,[490,774,888,179],function(){return e(e.s=9638)}),_N_E=e.O()}]);